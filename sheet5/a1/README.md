#   CBC Malleability (Aufgabe 1)

### In dieser Aufgabe sollen Sie den bekannten Klartext einer AES-CBC verschlüsselten Nachricht manipulieren. Dazu läuft auf Host 10.0.23.61 Port 1337 ein TCP-Server, der Kommandos der folgenden Form verarbeitet um einen gegebenen Geldbetrag auf ein gegebenes Konto zu überweisen:

##  TRANSFER AMOUNT `<amount>` REASON `<reason>` DEST `<dest>` END

### Um die Authentizität der Tranksaktionsanfragen sicherzustellen erwartet der Server die Anfragen AES-CBC verschlüsselt (AES-128) und anschliessend Base64 kodiert. Sie wurden angewiesen folgende Transaktion durchzuführen:

##  `TRANSFER AMOUNT $1000000 REASON Salary Jan. 2016 DEST #78384 END`

### Die dazu gültige Anfrage für den Server lautet:

##  `wUHhFdm5le/fLoF/G4U0u6FGSNVtkxFA3ZIEwYombzhGF2eYUCOutHTg0h16BtYlBd5FO/XlJkQ058Ev+8hTIA==`

##  1. Nutzen Sie diese Informationen um den Betrag stattdessen auf Ihr Konto #31337 zu überweisen.

The transaction length (in bytes) is 64. The AES-128 block size is 16 bytes (128 bits). Therefore, a transaction consists of 4 blocks.

So the transaction we want to modify is split as follows:

|TRANSFER AMOUNT |$1000000 REASON |Salary Jan. 2016| DEST #78384 END|

So we need to change the last block to " DEST #31337 END".

Since the last block in plaintext is generated by XORing the AES-128 decryption output for that block and the previous block's ciphertext, we can modify the latter so the result plaintext is the one we want to inject. By doing this, the previous block's plaintext will be changed as well, but since it matches exactly the `<reason>` field of the transaction (whose value is completely arbitrary, I assume), it will not break the processing of the transaction.

The script `cbc-decrypt.py` generates the valid request that will transfer the amount to the account #31337 instead. It is `wUHhFdm5le/fLoF/G4U0u6FGSNVtkxFA3ZIEwYombzhGF2eYUCOusH3g2R56BtYlBd5FO/XlJkQ058Ev+8hTIA==`.

##  2. Welches kryptographische Prinzip wurde verletzt und warum ist AES-CBC nicht geeignet um Authentizität sicherzustellen? Was wurden sie stattdessen verwenden?

The principle of Data Integrity has been violated on this exercise, because a known message is modified such as the server receives a different malicious message instead.